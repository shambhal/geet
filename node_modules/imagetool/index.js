 var thumb = require('node-thumbnail').thumb;
   
var path=require('path');
var fs=require('fs');
function createFolder(fp,settings)
{
	
	pa=split("/",fp);
	temp=settings.DIR_CACHE;
	for(i=0;i<pa.length,i++)
	{
		temp=path.join(temp,pa[i]);
		 if(!fs.existsSync(temp))
		 {
			fs.mkdir(temp) 
		 }
		 
		
		
		
		
	}
	return 1;
	
	
	
}
module.exports.create = function(file){
folderpath=	path.dirname(file);
ext=path.extname(file);
basename=path.basename(file,ext);
mb=basename+'_'+settings.thumbw+'.'+ext;

	p=path.join(settings.DIR_CACHE,folderpath,mb);
	  if(fs.existsSync(p))
	  {
		  
		  return path.join(folderpath,mb);
		  
		  
	  }
	  else{
		 ret= createFolder(folderpath);
		   if(ret==0)
		   {
			   
			   console.log("Error Occured");
			   return;
		   }
		   console.log(settings);
		   thumb({
	source:path.join(settings.DIR_IMAGE,file),
	width:settings.thumbw,
	destination:path.join(settings.DIR_CACHE,folderpath),
	suffix:settings.thumbw,
});
		  
	  }
 
};
